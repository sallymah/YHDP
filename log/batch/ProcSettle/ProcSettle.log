[main] 20170626 17:46:40 WARN  DBService            L:794  - DBCP borrow connection time: 5997 ms. batch
[main] 20170626 17:46:40 INFO  AbstractBatchBasic   L:109  - begin running
[main] 20170626 17:46:40 DEBUG TbBatchResultMgr     L:60   - sql: INSERT INTO TB_BATCH_RESULT(PROGRAM_NAME, START_DATE, START_TIME, END_DATE, END_TIME, WORK_FLAG, RCODE, ERROR_DESC, PAR_MON, PAR_DAY, LINK_CONTROL, JOB_ID, JOB_TIME, MEM_ID, RECOVER_VALUE) VALUES ('ProcSettle', '20170626', '174640', '', '', '0', '0000', '', '06', '26', 'N', '000', '000000', '', '')
[main] 20170626 17:46:40 DEBUG TbBatchResultMgr     L:64   - TB_BATCH_RESULT: 1 record inserted
[main] 20170626 17:46:40 DEBUG TbBatchResultMgr     L:65   - [TbBatchResultInfo  sProgramName:ProcSettle sStartDate:20170626 sStartTime:174640 sEndDate: sEndTime: sWorkFlag:0 sRcode:0000 sErrorDesc: sParMon:06 sParDay:26 sLinkControl:N sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20170626 17:46:41 WARN  DBService            L:794  - DBCP borrow connection time: 609 ms. common
[main] 20170626 17:46:41 DEBUG TbRcodeConfigMgr     L:1007 - sql: SELECT ROWID, RCODE, RCODE_DESC, BALANCE_FLAG, SUMMARY_FLAG, SETTLEMENT_FLAG, UPT_USERID, UPT_DATE, UPT_TIME, APRV_USERID, APRV_DATE, APRV_TIME FROM TB_RCODE_CONFIG ORDER BY RCODE
[main] 20170626 17:46:41 DEBUG TbRcodeConfigMgr     L:1015 - TB_RCODE_CONFIG: 5 records exist
[main] 20170626 17:46:41 DEBUG TbRcodeConfigMgr     L:1016 - [[TbRcodeConfigInfo  sRcode:2191 sRcodeDesc:卡號不存在 sBalanceFlag:0 sSummaryFlag:0 sSettlementFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime:], [TbRcodeConfigInfo  sRcode:2192 sRcodeDesc:卡片狀態不合法 sBalanceFlag:0 sSummaryFlag:0 sSettlementFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime:], [TbRcodeConfigInfo  sRcode:2193 sRcodeDesc:特店不存在 sBalanceFlag:0 sSummaryFlag:0 sSettlementFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime:], [TbRcodeConfigInfo  sRcode:2194 sRcodeDesc:端末機不存在 sBalanceFlag:0 sSummaryFlag:0 sSettlementFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime:], [TbRcodeConfigInfo  sRcode:2195 sRcodeDesc:取消交易查無原始交易 sBalanceFlag:0 sSummaryFlag:0 sSettlementFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime:]]
[main] 20170626 17:46:41 DEBUG TbSysConfigMgr       L:963  - sql: SELECT ROWID, PARM, VALUE, UPT_USERID, UPT_DATE, UPT_TIME, APRV_USERID, APRV_DATE, APRV_TIME, PURPOSE_DESC FROM TB_SYS_CONFIG ORDER BY PARM
[main] 20170626 17:46:41 DEBUG TbSysConfigMgr       L:971  - TB_SYS_CONFIG: 79 records exist
[main] 20170626 17:46:41 DEBUG TbSysConfigMgr       L:972  - [[TbSysConfigInfo  sParm:ALL_MEMBER sValue:99999999 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<OBUR> 主檔設定時, 以一個特殊值代表所有參加單位], [TbSysConfigInfo  sParm:APPLET_VERSION sValue:000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:卡片格式版本預設值], [TbSysConfigInfo  sParm:APPOINT_LIST_CANCEL_AUTO_BAL_UPDATE sValue:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 指定回饋名單取消, 若回饋已被下載, 系統不會自動負補登; 0表不會自動負補登, 1表會自動負補登], [TbSysConfigInfo  sParm:APPOINT_RELOAD_IMPORT sValue:~/UPLOAD/APPOINTRELOAD/ sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:指定加值匯入, 上傳檔案用的根目錄], [TbSysConfigInfo  sParm:AUTO_SETTLE_DAY_E sValue:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 自動結帳往前推天數。], [TbSysConfigInfo  sParm:AWARD_BONUS_AMT_CAN_EXCEED_MAX_LIMIT sValue:Y sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<C> 若之前的回饋加上本次回饋的點數或COUPON數量超過活動規定的上限時，回饋數量是否能超過上限, Y表可以超過, N表不能超過], [TbSysConfigInfo  sParm:BAD_BONUS_DAY sValue:7 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B>點數失效多久後,要處理餘額為負的資料], [TbSysConfigInfo  sParm:BAL_TRANSFER_ALLOWDAY sValue:999 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 餘額轉置有效結束日為永久有效(99991231); 或者, 以有效起始日之後N天為結束日], [TbSysConfigInfo  sParm:BAL_TRANSFER_DAY sValue:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<BU> 餘額轉置設定後N天可以到EDC進行餘額轉置], [TbSysConfigInfo  sParm:BATCH_RPT_PATH sValue:/home/svcadmin/REPORT/Output/BATCH_DATE/EXTERNAL/YHDP/ sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 報表產生的路徑], [TbSysConfigInfo  sParm:BATCH_RPT_PATH2 sValue:/home/svcadmin/REPORT/Output/BATCH_DATE/INTERNAL/YHDP_INTERNAL/ sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 報表產生的路徑(第二路徑)], [TbSysConfigInfo  sParm:BLACKLIST_IMPORT sValue:~/Upload/Blacklist/ sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:黑名單匯入, 上傳檔案用的根目錄], [TbSysConfigInfo  sParm:BLACKLIST_LIMIT_DAY sValue:  sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<O> ONLINE檢查黑名單版本，設定黑名單版本日期N天內有效(空值為不檢核)], [TbSysConfigInfo  sParm:BONUS_EXTEND_CHANNEL sValue:B sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 晶片紅利時, Coupon延展效期透過何種方式下載, B表補登, A表指定加值], [TbSysConfigInfo  sParm:BONUS_EXTEND_DAY sValue:35 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B>點數失效多久後, 要開始延展點數效期的, 設定一個時間避免有些離線交易未結帳上來], [TbSysConfigInfo  sParm:CANCEL_FLAG sValue:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 原交易取消後，原交易與取消交易是否清算及計算手續費, 0表不清算, 1表要清算], [TbSysConfigInfo  sParm:CAP_TXN_IMPORT sValue:~/UPLOAD/CapTxn/ sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:人工簽單匯入, 上傳檔案用的根目錄], [TbSysConfigInfo  sParm:CARD_FEE_BONUS_ID sValue:0000000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<OUB> 同步新增到TB_BONUS], [TbSysConfigInfo  sParm:CARD_RETURN_BONUS_ID sValue:0000000001 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<OUB> 同步新增到TB_BONUS], [TbSysConfigInfo  sParm:CHK_FIRMWARE_VER sValue:  sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<O> 檢查FIRMWARE可連線的版本(不得<此版本)], [TbSysConfigInfo  sParm:CHK_POSAPI_VER sValue:  sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<O> 檢查POS API可連線的版本(不得<此版本)], [TbSysConfigInfo  sParm:CLEAN_AFTER_DAY sValue:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> inactive客戶終止日期後N天清除所屬的點數/點券], [TbSysConfigInfo  sParm:COUPON_BAL_UPDATE_FLAG sValue:4 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<O>晶片紅利: 點券不夠扣處理原則,1: 正的足以抵掉此筆負補登才帶下去,2: 正的有多少扣多少, 其餘INSERT負補登(狀態為0),3: 主機餘額有多少扣多少, 其餘INSERT負補登(狀態為0),4: 永遠不帶下去(狀態為F)], [TbSysConfigInfo  sParm:CUSTOMER_REPROT_URL sValue:http:// sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:客製化報表下載功能的URL], [TbSysConfigInfo  sParm:CUST_IV sValue:0106050401030303 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:TB_CUST加解密IV], [TbSysConfigInfo  sParm:CUST_KEY sValue:0DA96BB119FA1ED8DD933DEB sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:TB_CUST加解密KEY], [TbSysConfigInfo  sParm:CUT_TIME_A sValue:000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 調帳交易在程式執行時，從現在往前找這個時間點(含)，之前未過檔的交易才過檔, 設成000000表未過檔的資料都過檔], [TbSysConfigInfo  sParm:CUT_TIME_C sValue:000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 人工簽單交易在程式執行時，從現在往前找這個時間點(含)，之前未過檔的交易才過檔, 設成000000表未過檔的資料都過檔], [TbSysConfigInfo  sParm:CUT_TIME_E sValue:000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> EDC交易在程式執行時，從現在往前找這個時間點(含)，之前未過檔的交易才過檔, 設成000000表未過檔的資料都過檔], [TbSysConfigInfo  sParm:CUT_TIME_I sValue:235959 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> Web Service在程式執行時，從現在往前找這個時間點(含)，之前未過檔的交易才過檔, 設成000000表未過檔的資料都過檔], [TbSysConfigInfo  sParm:CUT_UNBALANCED sValue:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 不平帳交易的交易是否過檔, 0表不過檔, 1表要過檔], [TbSysConfigInfo  sParm:END_DATE sValue:99991231 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:永久有效結束日期], [TbSysConfigInfo  sParm:EXTRA_PERCENTAGE sValue:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:每張額外製卡百分比], [TbSysConfigInfo  sParm:EX_MEM_ID sValue:00001001 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 紅利交換單位], [TbSysConfigInfo  sParm:FTP_REFILE_DEL_DAYS sValue:3 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> Ftp重複上傳檔案刪除幾天前重復檔案], [TbSysConfigInfo  sParm:FTP_RETRY_COUNT sValue:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> Ftp Retry 次數], [TbSysConfigInfo  sParm:FTP_RETRY_SLEEP sValue:3000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> Ftp Retry sleep 時間(ms)], [TbSysConfigInfo  sParm:FUNC sValue:0000110001111111111111111111111111100000 sUptUserid: sUptDate: sUptTime: sAprvUserid:20150528 sAprvDate: sAprvTime: sPurposeDesc:Online Default TERM.FUNC], [TbSysConfigInfo  sParm:GEN_EXP_RPT_DAY sValue:30 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 到期卡差異匯出N日前], [TbSysConfigInfo  sParm:HOLIDAY sValue:06 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<U>設定星期六為放假日], [TbSysConfigInfo  sParm:INIT_CARD_STATUS sValue:3 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 匯入「新卡通知檔」時, 卡片狀態預設為已開卡; 1表未遞交, 2表未開卡, 3表已開卡(若是儲值卡, 才建議設成2)], [TbSysConfigInfo  sParm:INIT_MERCH_STATUS sValue:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 匯入「特店通知檔」時，特店狀態預設為生效; 0表未生效, 1表生效], [TbSysConfigInfo  sParm:IS_CUST_ENCRIPT sValue:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:TB_CUST是否要作加解密 1:是 / 0:否], [TbSysConfigInfo  sParm:KEY_GROUP_ID sValue:00000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:], [TbSysConfigInfo  sParm:LOSTCARDBALDAY sValue:4 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 掛失與損毀回饋檔往前推算天數], [TbSysConfigInfo  sParm:LPTSAM_CHECK_FLAG sValue:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<O>關企版是否檢核LPTSAM總公司代碼,  0不檢核/1與未設定此PARM則需檢核], [TbSysConfigInfo  sParm:MAC_FALG sValue:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<O> MAC驗證測試], [TbSysConfigInfo  sParm:MASK sValue:A0B1C2D3E4F50A1B2C3D sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<O>亂碼化遮罩字串(文數字20碼 每一組hexString中必須有1個為字母A~F)], [TbSysConfigInfo  sParm:MAX_DW_COUPON sValue:5 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:最大可下載COUPON個數], [TbSysConfigInfo  sParm:MAX_DW_POINT sValue:2 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:最大可下載COUPON個數], [TbSysConfigInfo  sParm:ONLY_ALL_FLAG sValue:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 清算/手續費只處理當天或全部已過檔的交易, 0表當天, 1表全部], [TbSysConfigInfo  sParm:ONL_TXN_ENT_FILTER sValue:'50000', '77000' sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<OU>巨城及大食代的總公司代碼。當巨城及大食代在查詢TB_ONL_TXN資料時，要過濾部份交易資料。], [TbSysConfigInfo  sParm:POINT_BAL_UPDATE_FLAG sValue:3 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<O>晶片紅利: 點數不夠扣處理原則,1: 記錄負補登,2: 有多少扣多少(0),3: 有多少扣多少(F),4: 拒絕交易], [TbSysConfigInfo  sParm:REGEN_RCODE sValue:1007 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<U>踢退交易重匯-要重匯的錯誤代碼。], [TbSysConfigInfo  sParm:ROLLBACK_AFTER_REACH_QTY_LIMIT sValue:Y sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<Campaign>Y當負向交易時會重新計算設定REACH_MAX_FLAG], [TbSysConfigInfo  sParm:RPT_BATCH_DATE sValue:3 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R>Report執行批次報表的日期設定:1:當天交易,當天清算處理,當天產生報表(O),2:當天交易,當天清算處理,隔天產生報表(1),3:當天交易,隔天清算處理,隔天產生報表(2)], [TbSysConfigInfo  sParm:RPT_DATEFORMAT sValue:YMD sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 報表日期格式, 年月日的顯示順序], [TbSysConfigInfo  sParm:SCHEMA_VERSION sValue:2.2.7 sUptUserid: sUptDate:20170213 sUptTime:133920 sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:], [TbSysConfigInfo  sParm:SETTLE_EXPIRY_DATE sValue:45 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 批量匯入檔案判斷同一批交易結帳時間, 推算N天前已結帳但無交易檔], [TbSysConfigInfo  sParm:SETTLE_PARTITION sValue:2 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 清算程式處理全部已過檔的交易時, 因為效能考量, 只處理N個Partition內的資料(N=2~12)], [TbSysConfigInfo  sParm:START_DATE sValue:00010101 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:永久有效開始日期], [TbSysConfigInfo  sParm:SVC_INIT_CARD_STATUS sValue:2 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> SVC系統, 匯入「會員卡檔」時, 卡片狀態預設為已開卡; 1表未遞交, 2表未開卡, 3表已開卡(若是儲值卡, 才建議設成2)], [TbSysConfigInfo  sParm:SYS_START_DATE sValue:20141001 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:系統上線日], [TbSysConfigInfo  sParm:SYS_TYPE sValue:SVC sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B>判斷本系統是LMS or SVC], [TbSysConfigInfo  sParm:TERMINAL_IMPORT sValue:~/Upload/Terminal/ sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:端末機整批維護, 上傳端末機檔案用的根目錄], [TbSysConfigInfo  sParm:TOBE_STALL_MONTHS sValue:3 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:], [TbSysConfigInfo  sParm:TXN_SRC_A sValue:Adjustment sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 此交易來源顯示在報表上的名稱,調整交易], [TbSysConfigInfo  sParm:TXN_SRC_C sValue:Captured sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 此交易來源顯示在報表上的名稱,人工簽單], [TbSysConfigInfo  sParm:TXN_SRC_E sValue:EDC sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 顯示在報表上的名稱,EDC交易], [TbSysConfigInfo  sParm:TXN_SRC_L sValue:Batch sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 此交易來源顯示在報表上的名稱,指定回饋名單], [TbSysConfigInfo  sParm:TXN_SRC_P sValue:Batch sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 此交易來源顯示在報表上的名稱,指定加值], [TbSysConfigInfo  sParm:TXN_SRC_T sValue:Batch sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<R> 此交易來源顯示在報表上的名稱,餘額轉置], [TbSysConfigInfo  sParm:UNBAL_HANDLE_TYPE sValue:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 不平帳的後續處理方式; 1:以HOST為主, 2:以EDC為主, 3:人工決定], [TbSysConfigInfo  sParm:UNKNOWN_CARD_NO sValue:0000000000000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 匯入檔案/前置作業新增的交易, 因為無法得知卡號資訊, 統一填固定值], [TbSysConfigInfo  sParm:UNKNOWN_EXPIRY_DATE sValue:00000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 匯入檔案/前置作業新增的交易, 因為無法得知卡片效期資訊, 統一填固定值], [TbSysConfigInfo  sParm:UNKNOWN_MEMBER sValue:00000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 匯入檔案/前置作業新增的交易, 因為無法得知參加單位資訊, 統一填固定值], [TbSysConfigInfo  sParm:UNKNOWN_MERCH sValue:000000000000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 匯入檔案/前置作業新增的交易, 因為無法得知特店資訊, 統一填固定值], [TbSysConfigInfo  sParm:UNKNOWN_TERM sValue:00000000 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<B> 匯入檔案/前置作業新增的交易, 因為無法得知端末機資訊, 統一填固定值], [TbSysConfigInfo  sParm:WARRANTY sValue:24 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sPurposeDesc:<O> 保固期]]
[main] 20170626 17:46:41 DEBUG TbTxnDefMgr          L:1007 - sql: SELECT ROWID, TXN_CODE, TXN_CODE_DESC, SIGN, BAL_FLAG, UPT_USERID, UPT_DATE, UPT_TIME, APRV_USERID, APRV_DATE, APRV_TIME, SUM_TYPE FROM TB_TXN_DEF ORDER BY TXN_CODE
[main] 20170626 17:46:41 DEBUG TbTxnDefMgr          L:1015 - TB_TXN_DEF: 25 records exist
[main] 20170626 17:46:41 DEBUG TbTxnDefMgr          L:1016 - [[TbTxnDefInfo  sTxnCode:8206 sTxnCodeDesc:紅利抵扣退貨 sSign:P sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:C], [TbTxnDefInfo  sTxnCode:8207 sTxnCodeDesc:紅利抵扣 sSign:M sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:D], [TbTxnDefInfo  sTxnCode:8208 sTxnCodeDesc:紅利抵扣取消 sSign:P sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:C], [TbTxnDefInfo  sTxnCode:8507 sTxnCodeDesc:補登加點 sSign:N sBalFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:N], [TbTxnDefInfo  sTxnCode:8517 sTxnCodeDesc:補登扣點 sSign:N sBalFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:N], [TbTxnDefInfo  sTxnCode:8527 sTxnCodeDesc:餘額轉置 sSign:N sBalFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:N], [TbTxnDefInfo  sTxnCode:8537 sTxnCodeDesc:積點補登 sSign:P sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:C], [TbTxnDefInfo  sTxnCode:8577 sTxnCodeDesc:退卡 sSign:M sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:D], [TbTxnDefInfo  sTxnCode:8578 sTxnCodeDesc:退卡取消 sSign:P sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:C], [TbTxnDefInfo  sTxnCode:8597 sTxnCodeDesc:預儲金 sSign:P sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:C], [TbTxnDefInfo  sTxnCode:8706 sTxnCodeDesc:加值扣點 sSign:M sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:D], [TbTxnDefInfo  sTxnCode:8707 sTxnCodeDesc:加值 sSign:P sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:C], [TbTxnDefInfo  sTxnCode:8708 sTxnCodeDesc:加值取消 sSign:M sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:D], [TbTxnDefInfo  sTxnCode:8716 sTxnCodeDesc:自動加值退貨 sSign:M sBalFlag:1 sUptUserid: sUptDate:20150520 sUptTime: sAprvUserid: sAprvDate:20150520 sAprvTime: sSumType:C], [TbTxnDefInfo  sTxnCode:8717 sTxnCodeDesc:自動加值 sSign:P sBalFlag:1 sUptUserid: sUptDate:20150520 sUptTime: sAprvUserid: sAprvDate:20150520 sAprvTime: sSumType:C], [TbTxnDefInfo  sTxnCode:8718 sTxnCodeDesc:自動加值取消 sSign:M sBalFlag:1 sUptUserid: sUptDate:20150520 sUptTime: sAprvUserid: sAprvDate:20150520 sAprvTime: sSumType:D], [TbTxnDefInfo  sTxnCode:8727 sTxnCodeDesc:自動加值功能開啟 sSign:N sBalFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:N], [TbTxnDefInfo  sTxnCode:8806 sTxnCodeDesc:紅利回饋退貨 sSign:M sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:D], [TbTxnDefInfo  sTxnCode:8807 sTxnCodeDesc:紅利回饋 sSign:P sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:C], [TbTxnDefInfo  sTxnCode:8808 sTxnCodeDesc:紅利回饋取消 sSign:M sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:D], [TbTxnDefInfo  sTxnCode:8817 sTxnCodeDesc:指定紅利 sSign:P sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:OF], [TbTxnDefInfo  sTxnCode:8907 sTxnCodeDesc:須列帳UI調整交易加點 sSign:P sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:AF], [TbTxnDefInfo  sTxnCode:8917 sTxnCodeDesc:須列帳UI調整交易扣點 sSign:M sBalFlag:1 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:AF], [TbTxnDefInfo  sTxnCode:8927 sTxnCodeDesc:不列帳UI調整交易加點 sSign:P sBalFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:N], [TbTxnDefInfo  sTxnCode:8937 sTxnCodeDesc:不列帳UI調整交易扣點 sSign:M sBalFlag:0 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sSumType:N]]
[main] 20170626 17:46:41 DEBUG TbCenterMgr          L:963  - sql: SELECT ROWID, CENTER_ID, CENTER_NAME, UPT_USERID, UPT_DATE, UPT_TIME, APRV_USERID, APRV_DATE, APRV_TIME, LANGUAGE FROM TB_CENTER ORDER BY CENTER_ID
[main] 20170626 17:46:41 DEBUG TbCenterMgr          L:971  - TB_CENTER: 1 records exist
[main] 20170626 17:46:41 DEBUG TbCenterMgr          L:972  - [[TbCenterInfo  sCenterId:28472923 sCenterName:遠鑫營運中心 sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sLanguage:TWN]]
[main] 20170626 17:46:41 INFO  ProcSettle           L:423  - batchDate:20170626
[main] 20170626 17:46:41 INFO  ProcSettle           L:424  - recoverLevel:
[main] 20170626 17:46:41 INFO  ProcSettle           L:425  - commitCount:10000
[main] 20170626 17:46:41 INFO  ProcSettle           L:426  - ALL_MEMBER:99999999
[main] 20170626 17:46:41 INFO  ProcSettle           L:427  - ONLY_ALL_FLAG:1
[main] 20170626 17:46:41 INFO  ProcSettle           L:433  - SETTLE_PARTITION:2
[main] 20170626 17:46:41 DEBUG ProcSettle           L:440  - init(): ok.

[main] 20170626 17:46:41 INFO  ProcSettle           L:581  - remarkProcessedForTxnNoMatch() update TB_TRANS set  SETTLE_PROC_DATE='20170626' ,SETTLE_RCODE='0000' ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41TxnNoMatch.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )      and   CUT_DATE <= '20170626'      and settle_proc_date is null      AND (card_no, expiry_date, lms_invoice_no) not in (       select t.card_no, t.expiry_date, t.lms_invoice_no        from TB_TRANS t, TB_TRANS_DTL d        where   ( t.PAR_MON='05' or (t.PAR_MON='06' and t.PAR_DAY<='26') )          and   t.CUT_DATE <= '20170626'          and t.settle_proc_date is null          and t.settle_succ_date is null          and t.settle_rcode='0000'         and t.card_no=d.card_no and t.expiry_date=d.expiry_date and t.lms_invoice_no=d.lms_invoice_no ) 
[main] 20170626 17:46:41 DEBUG DBService            L:1155 - update TB_TRANS set  SETTLE_PROC_DATE='20170626' ,SETTLE_RCODE='0000' ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41TxnNoMatch.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )      and   CUT_DATE <= '20170626'      and settle_proc_date is null      AND (card_no, expiry_date, lms_invoice_no) not in (       select t.card_no, t.expiry_date, t.lms_invoice_no        from TB_TRANS t, TB_TRANS_DTL d        where   ( t.PAR_MON='05' or (t.PAR_MON='06' and t.PAR_DAY<='26') )          and   t.CUT_DATE <= '20170626'          and t.settle_proc_date is null          and t.settle_succ_date is null          and t.settle_rcode='0000'         and t.card_no=d.card_no and t.expiry_date=d.expiry_date and t.lms_invoice_no=d.lms_invoice_no ) 
[main] 20170626 17:46:41 WARN  DBService            L:1179 - SQL stmt update time: 63 ms[update TB_TRANS set  SETTLE_PROC_DATE='20170626' ,SETTLE_RCODE='0000' ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41TxnNoMatch.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )      and   CUT_DATE <= '20170626'      and settle_proc_date is null      AND (card_no, expiry_date, lms_invoice_no) not in (       select t.card_no, t.expiry_date, t.lms_invoice_no        from TB_TRANS t, TB_TRANS_DTL d        where   ( t.PAR_MON='05' or (t.PAR_MON='06' and t.PAR_DAY<='26') )          and   t.CUT_DATE <= '20170626'          and t.settle_proc_date is null          and t.settle_succ_date is null          and t.settle_rcode='0000'         and t.card_no=d.card_no and t.expiry_date=d.expiry_date and t.lms_invoice_no=d.lms_invoice_no ) ]
[main] 20170626 17:46:41 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:41 INFO  ProcSettle           L:620  - remarkProcessedForTxnDtlNoMatch() update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='2405'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41TxnDtlNoMatch.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (card_no, expiry_date, lms_invoice_no) in (       select card_no, expiry_date, lms_invoice_no from TB_TRANS_DTL        where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )         and settle_proc_date is null      AND NOT EXISTS (         select d.card_no, d.expiry_date, d.lms_invoice_no           from TB_TRANS t, TB_TRANS_DTL d          where   ( t.PAR_MON='05' or (t.PAR_MON='06' and t.PAR_DAY<='26') )           and   t.CUT_DATE <= '20170626'           and t.settle_proc_date is null           and t.card_no=d.card_no and t.expiry_date=d.expiry_date and t.lms_invoice_no=d.lms_invoice_no ) )
[main] 20170626 17:46:41 DEBUG DBService            L:1155 - update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='2405'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41TxnDtlNoMatch.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (card_no, expiry_date, lms_invoice_no) in (       select card_no, expiry_date, lms_invoice_no from TB_TRANS_DTL        where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )         and settle_proc_date is null      AND NOT EXISTS (         select d.card_no, d.expiry_date, d.lms_invoice_no           from TB_TRANS t, TB_TRANS_DTL d          where   ( t.PAR_MON='05' or (t.PAR_MON='06' and t.PAR_DAY<='26') )           and   t.CUT_DATE <= '20170626'           and t.settle_proc_date is null           and t.card_no=d.card_no and t.expiry_date=d.expiry_date and t.lms_invoice_no=d.lms_invoice_no ) )
[main] 20170626 17:46:41 WARN  DBService            L:1179 - SQL stmt update time: 31 ms[update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='2405'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41TxnDtlNoMatch.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (card_no, expiry_date, lms_invoice_no) in (       select card_no, expiry_date, lms_invoice_no from TB_TRANS_DTL        where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )         and settle_proc_date is null      AND NOT EXISTS (         select d.card_no, d.expiry_date, d.lms_invoice_no           from TB_TRANS t, TB_TRANS_DTL d          where   ( t.PAR_MON='05' or (t.PAR_MON='06' and t.PAR_DAY<='26') )           and   t.CUT_DATE <= '20170626'           and t.settle_proc_date is null           and t.card_no=d.card_no and t.expiry_date=d.expiry_date and t.lms_invoice_no=d.lms_invoice_no ) )]
[main] 20170626 17:46:41 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:41 INFO  ProcSettle           L:662  - handleOrigCancelTxn() Update TB_TRANS_DTL set   SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41OrigCancelTxn.') where  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in         (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO from TB_TRANS         where  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )            and SETTLE_PROC_DATE is null            and (  CUT_DATE <= '20170626' )           and (STATUS = 'C' or P_CODE IN (SELECT P_CODE FROM TB_P_CODE_DEF WHERE IS_SETL_FLAG = '0' AND P_CODE LIKE '%8')) )
[main] 20170626 17:46:41 DEBUG DBService            L:1155 - Update TB_TRANS_DTL set   SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41OrigCancelTxn.') where  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in         (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO from TB_TRANS         where  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )            and SETTLE_PROC_DATE is null            and (  CUT_DATE <= '20170626' )           and (STATUS = 'C' or P_CODE IN (SELECT P_CODE FROM TB_P_CODE_DEF WHERE IS_SETL_FLAG = '0' AND P_CODE LIKE '%8')) )
[main] 20170626 17:46:41 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:41 INFO  ProcSettle           L:684  - handleOrigCancelTxn() Update TB_TRANS set SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41OrigCancelTxn.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and (  CUT_DATE <= '20170626' )   and SETTLE_PROC_DATE is null    and (STATUS = 'C' or P_CODE IN (SELECT P_CODE FROM TB_P_CODE_DEF WHERE IS_SETL_FLAG = '0' AND P_CODE LIKE '%8'))
[main] 20170626 17:46:41 DEBUG DBService            L:1155 - Update TB_TRANS set SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41OrigCancelTxn.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and (  CUT_DATE <= '20170626' )   and SETTLE_PROC_DATE is null    and (STATUS = 'C' or P_CODE IN (SELECT P_CODE FROM TB_P_CODE_DEF WHERE IS_SETL_FLAG = '0' AND P_CODE LIKE '%8'))
[main] 20170626 17:46:41 WARN  DBService            L:1179 - SQL stmt update time: 15 ms[Update TB_TRANS set SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41OrigCancelTxn.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and (  CUT_DATE <= '20170626' )   and SETTLE_PROC_DATE is null    and (STATUS = 'C' or P_CODE IN (SELECT P_CODE FROM TB_P_CODE_DEF WHERE IS_SETL_FLAG = '0' AND P_CODE LIKE '%8'))]
[main] 20170626 17:46:41 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:41 INFO  ProcSettle           L:727  - remarkProcessedForInvalidTxn() update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='2401' where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in        (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO From TB_TRANS          where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )             and   CUT_DATE <= '20170626'             and SETTLE_PROC_DATE is null             and CHECK_FLAG = 1            and (CARD_NO,EXPIRY_DATE,LMS_INVOICE_NO) in                (select CARD_NO,EXPIRY_DATE,LMS_INVOICE_NO from TB_TRANS_CHECK_ERR                  where CHECK_RCODE in                  (Select RCODE From TB_RCODE_CONFIG Where SETTLEMENT_FLAG='0'))        )
[main] 20170626 17:46:41 DEBUG DBService            L:1155 - update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='2401' where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in        (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO From TB_TRANS          where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )             and   CUT_DATE <= '20170626'             and SETTLE_PROC_DATE is null             and CHECK_FLAG = 1            and (CARD_NO,EXPIRY_DATE,LMS_INVOICE_NO) in                (select CARD_NO,EXPIRY_DATE,LMS_INVOICE_NO from TB_TRANS_CHECK_ERR                  where CHECK_RCODE in                  (Select RCODE From TB_RCODE_CONFIG Where SETTLEMENT_FLAG='0'))        )
[main] 20170626 17:46:41 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:41 INFO  ProcSettle           L:755  - remarkProcessedForNoNeedSettleBonus() update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41NoNeedSettleBonus.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and BONUS_ID in ( select BONUS_ID from TB_BONUS where SETTLEMENT_FLAG='0')
[main] 20170626 17:46:41 DEBUG DBService            L:1155 - update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41NoNeedSettleBonus.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and BONUS_ID in ( select BONUS_ID from TB_BONUS where SETTLEMENT_FLAG='0')
[main] 20170626 17:46:41 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:41 INFO  ProcSettle           L:830  - remarkProcessedForNoNeedSettleTxn() update TB_TRANS_DTL set   SETTLE_PROC_DATE='20170626' ,SETTLE_RCODE='0000' ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41NoSetSettleTxn.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (P_CODE, TXN_CODE) not in (select T.P_CODE, T.TXN_CODE  from TB_SETTLE_CONFIG C, TB_SETTLE_TXN T  where C.SETTLE_CODE=T.SETTLE_CODE   and C.VALID_SDATE<='20170626'   and C.VALID_EDATE>='20170626')
[main] 20170626 17:46:41 DEBUG DBService            L:1155 - update TB_TRANS_DTL set   SETTLE_PROC_DATE='20170626' ,SETTLE_RCODE='0000' ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41NoSetSettleTxn.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (P_CODE, TXN_CODE) not in (select T.P_CODE, T.TXN_CODE  from TB_SETTLE_CONFIG C, TB_SETTLE_TXN T  where C.SETTLE_CODE=T.SETTLE_CODE   and C.VALID_SDATE<='20170626'   and C.VALID_EDATE>='20170626')
[main] 20170626 17:46:41 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:41 INFO  ProcSettle           L:792  - remarkProcessedForNoSetSettleBonus() update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41NoSetSettleBonus.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (P_CODE, TXN_CODE, BONUS_ID) not in (select T.P_CODE, T.TXN_CODE, C.BONUS_ID  from TB_SETTLE_CONFIG C, TB_SETTLE_TXN T  where C.SETTLE_CODE=T.SETTLE_CODE   and C.VALID_SDATE<='20170626'   and C.VALID_EDATE>='20170626')
[main] 20170626 17:46:41 DEBUG DBService            L:1155 - update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41NoSetSettleBonus.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (P_CODE, TXN_CODE, BONUS_ID) not in (select T.P_CODE, T.TXN_CODE, C.BONUS_ID  from TB_SETTLE_CONFIG C, TB_SETTLE_TXN T  where C.SETTLE_CODE=T.SETTLE_CODE   and C.VALID_SDATE<='20170626'   and C.VALID_EDATE>='20170626')
[main] 20170626 17:46:41 WARN  DBService            L:1179 - SQL stmt update time: 15 ms[update TB_TRANS_DTL set    SETTLE_PROC_DATE='20170626'  ,SETTLE_RCODE='0000'  ,TXN_NOTE=(TXN_NOTE||'[SETTLE]17:46:41NoSetSettleBonus.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null    and (P_CODE, TXN_CODE, BONUS_ID) not in (select T.P_CODE, T.TXN_CODE, C.BONUS_ID  from TB_SETTLE_CONFIG C, TB_SETTLE_TXN T  where C.SETTLE_CODE=T.SETTLE_CODE   and C.VALID_SDATE<='20170626'   and C.VALID_EDATE>='20170626')]
[main] 20170626 17:46:41 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:41 DEBUG ProcSettle           L:914  - settleConfigVtr: [{VALID_SDATE=00010101, BONUS_ID=1100000161, SETTLE_TARGET=1, SETTLE_RATE=1, ACQ_MEM_ID=00125060, CARRY_TYPE=O, SETTLE_CODE=U2I1, SETTLE_FROM=BONUS_QTY, VALID_EDATE=29991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=000, CARRY_DIGIT=2}, {VALID_SDATE=00010101, BONUS_ID=1100000161, SETTLE_TARGET=1, SETTLE_RATE=1, ACQ_MEM_ID=00125060, CARRY_TYPE=O, SETTLE_CODE=IU01, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=00010101, BONUS_ID=1100000161, SETTLE_TARGET=1, SETTLE_RATE=1, ACQ_MEM_ID=00103218, CARRY_TYPE=O, SETTLE_CODE=U2I1, SETTLE_FROM=BONUS_QTY, VALID_EDATE=29991231, ISS_MEM_ID=00001001, BANK_ID=808, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150101, BONUS_ID=1100000161, SETTLE_TARGET=1, SETTLE_RATE=1, ACQ_MEM_ID=00001072, CARRY_TYPE=U, SETTLE_CODE=U2I1, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20160401, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=28000001, CARRY_TYPE=O, SETTLE_CODE=S203, SETTLE_FROM=BONUS_QTY, VALID_EDATE=29991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=000, CARRY_DIGIT=2}, {VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=81000003, CARRY_TYPE=O, SETTLE_CODE=ACQ2ISS, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=81000003, CARRY_TYPE=O, SETTLE_CODE=A2I9, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00163042, CARRY_TYPE=O, SETTLE_CODE=S2001, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D01, CARRY_DIGIT=2}, {VALID_SDATE=20150101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00079028, CARRY_TYPE=U, SETTLE_CODE=S2001, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=00001001, BANK_ID=888, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20141201, BONUS_ID=1200000004, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00001001, CARRY_TYPE=U, SETTLE_CODE=a2i, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=28472923, BANK_ID=807, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20141201, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00001001, CARRY_TYPE=U, SETTLE_CODE=a2i, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=28472923, BANK_ID=807, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20141201, BONUS_ID=1200000004, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00001001, CARRY_TYPE=U, SETTLE_CODE=ISS2ACQ, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=28472923, BANK_ID=807, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20141201, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00001001, CARRY_TYPE=U, SETTLE_CODE=ISS2ACQ, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=28472923, BANK_ID=807, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20160401, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=90000001, CARRY_TYPE=U, SETTLE_CODE=S1200, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=0000000000, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00061001, CARRY_TYPE=O, SETTLE_CODE=Test, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=231, FUND_TYPE=D01, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=0000000000, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00100097, CARRY_TYPE=O, SETTLE_CODE=Test, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D01, CARRY_DIGIT=2}, {VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00118001, CARRY_TYPE=O, SETTLE_CODE=TR01, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00118001, CARRY_TYPE=O, SETTLE_CODE=ISS2ACQ, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20161001, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00118001, CARRY_TYPE=O, SETTLE_CODE=TR02, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20161001, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00118001, CARRY_TYPE=U, SETTLE_CODE=TR03, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00077081, CARRY_TYPE=O, SETTLE_CODE=TR01, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=0000000000, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00077081, CARRY_TYPE=O, SETTLE_CODE=Test, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D01, CARRY_DIGIT=2}, {VALID_SDATE=20160401, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=50000001, CARRY_TYPE=U, SETTLE_CODE=9112, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=0000000000, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00043057, CARRY_TYPE=O, SETTLE_CODE=Test, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D01, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1092, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2001, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1000, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2002, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1.1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2092, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=3}, {VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2091, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20160701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=U, SETTLE_CODE=S2003, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20180701, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=000, CARRY_DIGIT=2}, {VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1000, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1092, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1091, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1.5, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1200, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2002, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1091, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1200, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}, {VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2001, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}]
[main] 20170626 17:46:41 INFO  ProcSettle           L:922  - select SETTLE_CODE, ACQ_MEM_ID, ISS_MEM_ID, BONUS_ID,  SETTLE_FROM, SETTLE_RATE, CARRY_DIGIT, CARRY_TYPE,  VALID_SDATE, VALID_EDATE, FUND_TYPE, SETTLE_TARGET, BANK_ID  FROM TB_SETTLE_CONFIG, TB_MEMBER  WHERE VALID_SDATE<='20170626' AND VALID_EDATE>='20170626' AND TB_SETTLE_CONFIG.ACQ_MEM_ID = TB_MEMBER.MEM_ID(+) 
[main] 20170626 17:46:41 DEBUG ProcSettle           L:321  - -------- filterSettleConfig --------
[main] 20170626 17:46:41 DEBUG ProcSettle           L:322  - getBatchResultInfo().getJobId():  000
[main] 20170626 17:46:41 DEBUG ProcSettle           L:323  - getBatchResultInfo().getJobTime():000000
[main] 20170626 17:46:41 DEBUG ProcSettle           L:324  - getBatchResultInfo().getMemId():  
[main] 20170626 17:46:41 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:41 DEBUG ProcSettle           L:961  - settleTxnVtr.size():2
[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 0 pCode=4717 txnCode=8717
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='4717' and TXN_CODE='8717' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' AND (CARD_NO, EXPIRY_DATE) IN ( SELECT CARD_NO, EXPIRY_DATE FROM TB_CARD WHERE BANK_ID = '') and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 1 pCode=7717 txnCode=8717
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7717' and TXN_CODE='8717' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' AND (CARD_NO, EXPIRY_DATE) IN ( SELECT CARD_NO, EXPIRY_DATE FROM TB_CARD WHERE BANK_ID = '') and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=U, CREDIT_UNIT=I, ACCOUNT_CODE=S104}] settleConfigList:{VALID_SDATE=00010101, BONUS_ID=1100000161, SETTLE_TARGET=1, SETTLE_RATE=1, ACQ_MEM_ID=00125060, CARRY_TYPE=O, SETTLE_CODE=U2I1, SETTLE_FROM=BONUS_QTY, VALID_EDATE=29991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=000, CARRY_DIGIT=2}

[main] 20170626 17:46:41 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:41 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 0 pCode=7737 txnCode=8717
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7737' and TXN_CODE='8717' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' AND (CARD_NO, EXPIRY_DATE) IN ( SELECT CARD_NO, EXPIRY_DATE FROM TB_CARD WHERE BANK_ID = '') and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=U, CREDIT_UNIT=I, ACCOUNT_CODE=S104}] settleConfigList:{VALID_SDATE=00010101, BONUS_ID=1100000161, SETTLE_TARGET=1, SETTLE_RATE=1, ACQ_MEM_ID=00125060, CARRY_TYPE=O, SETTLE_CODE=IU01, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:41 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:41 DEBUG ProcSettle           L:961  - settleTxnVtr.size():2
[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 0 pCode=4717 txnCode=8717
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='4717' and TXN_CODE='8717' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' AND (CARD_NO, EXPIRY_DATE) IN ( SELECT CARD_NO, EXPIRY_DATE FROM TB_CARD WHERE BANK_ID = '808') and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 1 pCode=7717 txnCode=8717
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7717' and TXN_CODE='8717' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' AND (CARD_NO, EXPIRY_DATE) IN ( SELECT CARD_NO, EXPIRY_DATE FROM TB_CARD WHERE BANK_ID = '808') and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=U, CREDIT_UNIT=I, ACCOUNT_CODE=S104}] settleConfigList:{VALID_SDATE=00010101, BONUS_ID=1100000161, SETTLE_TARGET=1, SETTLE_RATE=1, ACQ_MEM_ID=00103218, CARRY_TYPE=O, SETTLE_CODE=U2I1, SETTLE_FROM=BONUS_QTY, VALID_EDATE=29991231, ISS_MEM_ID=00001001, BANK_ID=808, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:41 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:41 DEBUG ProcSettle           L:961  - settleTxnVtr.size():2
[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 0 pCode=4717 txnCode=8717
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='4717' and TXN_CODE='8717' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' AND (CARD_NO, EXPIRY_DATE) IN ( SELECT CARD_NO, EXPIRY_DATE FROM TB_CARD WHERE BANK_ID = '') and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 1 pCode=7717 txnCode=8717
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7717' and TXN_CODE='8717' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' AND (CARD_NO, EXPIRY_DATE) IN ( SELECT CARD_NO, EXPIRY_DATE FROM TB_CARD WHERE BANK_ID = '') and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=U, CREDIT_UNIT=I, ACCOUNT_CODE=S104}] settleConfigList:{VALID_SDATE=20150101, BONUS_ID=1100000161, SETTLE_TARGET=1, SETTLE_RATE=1, ACQ_MEM_ID=00001072, CARRY_TYPE=U, SETTLE_CODE=U2I1, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:41 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:41 WARN  ProcSettle           L:944  - No data matches settleCode: S203 in TB_SETTLE_DEF
[main] 20170626 17:46:41 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:41 DEBUG ProcSettle           L:961  - settleTxnVtr.size():4
[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 0 pCode=7117 txnCode=8597
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7117' and TXN_CODE='8597' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='81000003' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 1 pCode=7707 txnCode=8507
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7707' and TXN_CODE='8507' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='81000003' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 2 pCode=7646 txnCode=8806
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7646' and TXN_CODE='8806' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='81000003' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:41 DEBUG ProcSettle           L:975  - 3 pCode=7216 txnCode=8206
[main] 20170626 17:46:41 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7216' and TXN_CODE='8206' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='81000003' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=A, CREDIT_UNIT=I, ACCOUNT_CODE=S100}] settleConfigList:{VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=81000003, CARRY_TYPE=O, SETTLE_CODE=ACQ2ISS, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 0 pCode=7707 txnCode=8707
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7707' and TXN_CODE='8707' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='81000003' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=A, CREDIT_UNIT=I, ACCOUNT_CODE=S100}] settleConfigList:{VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=81000003, CARRY_TYPE=O, SETTLE_CODE=A2I9, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 WARN  ProcSettle           L:958  - No data matches settleCode: S2001 in TB_SETTLE_TXN
[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 WARN  ProcSettle           L:958  - No data matches settleCode: S2001 in TB_SETTLE_TXN
[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 WARN  ProcSettle           L:944  - No data matches settleCode: a2i in TB_SETTLE_DEF
[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 WARN  ProcSettle           L:944  - No data matches settleCode: a2i in TB_SETTLE_DEF
[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 DEBUG ProcSettle           L:961  - settleTxnVtr.size():9
[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 0 pCode=7707 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7707' and TXN_CODE='8807' and BONUS_ID='1200000004' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 1 pCode=7117 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7117' and TXN_CODE='8807' and BONUS_ID='1200000004' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 2 pCode=7647 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7647' and TXN_CODE='8807' and BONUS_ID='1200000004' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 3 pCode=7207 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7207' and TXN_CODE='8207' and BONUS_ID='1200000004' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 4 pCode=7217 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7217' and TXN_CODE='8207' and BONUS_ID='1200000004' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 5 pCode=7807 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7807' and TXN_CODE='8807' and BONUS_ID='1200000004' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 6 pCode=7547 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7547' and TXN_CODE='8207' and BONUS_ID='1200000004' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 7 pCode=7307 txnCode=8817
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7307' and TXN_CODE='8817' and BONUS_ID='1200000004' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 8 pCode=7537 txnCode=8537
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7537' and TXN_CODE='8537' and BONUS_ID='1200000004' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=I, CREDIT_UNIT=A, ACCOUNT_CODE=S200}] settleConfigList:{VALID_SDATE=20141201, BONUS_ID=1200000004, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00001001, CARRY_TYPE=U, SETTLE_CODE=ISS2ACQ, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=28472923, BANK_ID=807, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 DEBUG ProcSettle           L:961  - settleTxnVtr.size():9
[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 0 pCode=7707 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7707' and TXN_CODE='8807' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 1 pCode=7117 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7117' and TXN_CODE='8807' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 2 pCode=7647 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7647' and TXN_CODE='8807' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 3 pCode=7207 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7207' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 4 pCode=7217 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7217' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 5 pCode=7807 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7807' and TXN_CODE='8807' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 6 pCode=7547 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7547' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 7 pCode=7307 txnCode=8817
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7307' and TXN_CODE='8817' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 8 pCode=7537 txnCode=8537
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7537' and TXN_CODE='8537' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00001001' and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=I, CREDIT_UNIT=A, ACCOUNT_CODE=S200}] settleConfigList:{VALID_SDATE=20141201, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00001001, CARRY_TYPE=U, SETTLE_CODE=ISS2ACQ, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=28472923, BANK_ID=807, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 0 pCode=7527 txnCode=8577
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7527' and TXN_CODE='8577' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='90000001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=I, CREDIT_UNIT=A, ACCOUNT_CODE=S120}] settleConfigList:{VALID_SDATE=20160401, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=90000001, CARRY_TYPE=U, SETTLE_CODE=S1200, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 WARN  ProcSettle           L:944  - No data matches settleCode: Test in TB_SETTLE_DEF
[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 WARN  ProcSettle           L:944  - No data matches settleCode: Test in TB_SETTLE_DEF
[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 DEBUG ProcSettle           L:961  - settleTxnVtr.size():4
[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 0 pCode=7435 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7435' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 1 pCode=7488 txnCode=8208
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7488' and TXN_CODE='8208' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 2 pCode=7617 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7617' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 3 pCode=7627 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7627' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=I, CREDIT_UNIT=A, ACCOUNT_CODE=S200}] settleConfigList:{VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00118001, CARRY_TYPE=O, SETTLE_CODE=TR01, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 DEBUG ProcSettle           L:961  - settleTxnVtr.size():9
[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 0 pCode=7707 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7707' and TXN_CODE='8807' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 1 pCode=7117 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7117' and TXN_CODE='8807' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 2 pCode=7647 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7647' and TXN_CODE='8807' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 3 pCode=7207 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7207' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 4 pCode=7217 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7217' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 5 pCode=7807 txnCode=8807
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7807' and TXN_CODE='8807' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 6 pCode=7547 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7547' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 7 pCode=7307 txnCode=8817
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7307' and TXN_CODE='8817' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 8 pCode=7537 txnCode=8537
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7537' and TXN_CODE='8537' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=I, CREDIT_UNIT=A, ACCOUNT_CODE=S200}] settleConfigList:{VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00118001, CARRY_TYPE=O, SETTLE_CODE=ISS2ACQ, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 0 pCode=7429 txnCode=8707
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7429' and TXN_CODE='8707' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=A, CREDIT_UNIT=I, ACCOUNT_CODE=S100}] settleConfigList:{VALID_SDATE=20161001, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00118001, CARRY_TYPE=O, SETTLE_CODE=TR02, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:42 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:42 DEBUG ProcSettle           L:961  - settleTxnVtr.size():5
[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 0 pCode=7430 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7430' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:42 DEBUG ProcSettle           L:975  - 1 pCode=7431 txnCode=8207
[main] 20170626 17:46:42 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7431' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 2 pCode=7432 txnCode=8207
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7432' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 3 pCode=7433 txnCode=8207
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7433' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 4 pCode=7434 txnCode=8207
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7434' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00118001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=I, CREDIT_UNIT=A, ACCOUNT_CODE=S200}] settleConfigList:{VALID_SDATE=20161001, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00118001, CARRY_TYPE=U, SETTLE_CODE=TR03, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20201231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():4
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7435 txnCode=8207
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7435' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00077081' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 1 pCode=7488 txnCode=8208
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7488' and TXN_CODE='8208' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00077081' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 2 pCode=7617 txnCode=8207
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7617' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00077081' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 3 pCode=7627 txnCode=8207
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7627' and TXN_CODE='8207' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='00077081' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=I, CREDIT_UNIT=A, ACCOUNT_CODE=S200}] settleConfigList:{VALID_SDATE=20160101, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=00077081, CARRY_TYPE=O, SETTLE_CODE=TR01, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 WARN  ProcSettle           L:944  - No data matches settleCode: Test in TB_SETTLE_DEF
[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():4
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7967 txnCode=8917
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7967' and TXN_CODE='8917' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='50000001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 1 pCode=7977 txnCode=8907
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7977' and TXN_CODE='8907' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='50000001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 2 pCode=7987 txnCode=8917
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7987' and TXN_CODE='8917' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='50000001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 3 pCode=7997 txnCode=8907
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7997' and TXN_CODE='8907' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ACQ_MEM_ID='50000001' and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=A, CREDIT_UNIT=I, ACCOUNT_CODE=S100}] settleConfigList:{VALID_SDATE=20160401, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=50000001, CARRY_TYPE=U, SETTLE_CODE=9112, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 WARN  ProcSettle           L:944  - No data matches settleCode: Test in TB_SETTLE_DEF
[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7937 txnCode=8917
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7937' and TXN_CODE='8917' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=N, CREDIT_UNIT=N, ACCOUNT_CODE=S109}] settleConfigList:{VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1092, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 WARN  ProcSettle           L:958  - No data matches settleCode: S2001 in TB_SETTLE_TXN
[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 WARN  ProcSettle           L:958  - No data matches settleCode: S1000 in TB_SETTLE_TXN
[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7646 txnCode=8206
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7646' and TXN_CODE='8206' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=A, CREDIT_UNIT=I, ACCOUNT_CODE=S100}] settleConfigList:{VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2002, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7927 txnCode=8907
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7927' and TXN_CODE='8907' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=U, CREDIT_UNIT=N, ACCOUNT_CODE=S209}] settleConfigList:{VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1.1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2092, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=3}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7917 txnCode=8917
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7917' and TXN_CODE='8917' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=N, CREDIT_UNIT=N, ACCOUNT_CODE=S209}] settleConfigList:{VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2091, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7408 txnCode=8208
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7408' and TXN_CODE='8208' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=A, CREDIT_UNIT=I, ACCOUNT_CODE=S200}] settleConfigList:{VALID_SDATE=20160701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=U, SETTLE_CODE=S2003, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20180701, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=000, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 WARN  ProcSettle           L:958  - No data matches settleCode: S1000 in TB_SETTLE_TXN
[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7937 txnCode=8917
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7937' and TXN_CODE='8917' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=N, CREDIT_UNIT=N, ACCOUNT_CODE=S109}] settleConfigList:{VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1092, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7947 txnCode=8907
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7947' and TXN_CODE='8907' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=N, CREDIT_UNIT=N, ACCOUNT_CODE=S109}] settleConfigList:{VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1091, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7527 txnCode=8577
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7527' and TXN_CODE='8577' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=I, CREDIT_UNIT=A, ACCOUNT_CODE=S120}] settleConfigList:{VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1.5, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1200, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7646 txnCode=8206
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7646' and TXN_CODE='8206' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='00001001' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=A, CREDIT_UNIT=I, ACCOUNT_CODE=S100}] settleConfigList:{VALID_SDATE=20150501, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S2002, SETTLE_FROM=BONUS_QTY, VALID_EDATE=99991231, ISS_MEM_ID=00001001, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7947 txnCode=8907
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7947' and TXN_CODE='8907' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=N, CREDIT_UNIT=N, ACCOUNT_CODE=S109}] settleConfigList:{VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1091, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 DEBUG ProcSettle           L:961  - settleTxnVtr.size():1
[main] 20170626 17:46:43 DEBUG ProcSettle           L:975  - 0 pCode=7527 txnCode=8577
[main] 20170626 17:46:43 DEBUG ProcSettle           L:1164 - getTransactionSqlCmd():select  a.CARD_NO, a.EXPIRY_DATE, a.LMS_INVOICE_NO, a.P_CODE, a.TXN_CODE, a.BONUS_ID,  a.BONUS_SDATE, a.BONUS_EDATE, a.BONUS_QTY, a.TXN_REDEEM_AMT, a.CREDIT_UNIT, a.DEBIT_UNIT, a.CREDIT_ID, a.DEBIT_ID, b.ACQ_MEM_ID, b.ISS_MEM_ID, b.MERCH_ID, b.TERM_ID, b.BATCH_NO, b.TERM_SETTLE_DATE, b.TERM_SETTLE_TIME  from (select * from TB_TRANS_DTL where  P_CODE='7527' and TXN_CODE='8577' and BONUS_ID='1100000161' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) a,(select * from TB_TRANS where   CUT_DATE <= '20170626'  and ISS_MEM_ID='28472923' and  ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') ) ) b  where a.CARD_NO=b.CARD_NO   and a.EXPIRY_DATE=b.EXPIRY_DATE   and a.LMS_INVOICE_NO=b.LMS_INVOICE_NO   and a.settle_proc_date is null    and a.settle_rcode='0000'   and b.settle_proc_date is null    and b.settle_rcode='0000'

[main] 20170626 17:46:43 DEBUG ProcSettle           L:1013 - [{DEBIT_UNIT=I, CREDIT_UNIT=A, ACCOUNT_CODE=S120}] settleConfigList:{VALID_SDATE=20140701, BONUS_ID=1100000161, SETTLE_TARGET=0, SETTLE_RATE=1, ACQ_MEM_ID=99999999, CARRY_TYPE=O, SETTLE_CODE=S1200, SETTLE_FROM=BONUS_QTY, VALID_EDATE=20991231, ISS_MEM_ID=28472923, BANK_ID=, FUND_TYPE=D00, CARRY_DIGIT=2}

[main] 20170626 17:46:43 DEBUG ProcSettle           L:935  - action()!
[main] 20170626 17:46:43 WARN  ProcSettle           L:958  - No data matches settleCode: S2001 in TB_SETTLE_TXN
[main] 20170626 17:46:43 INFO  ProcSettle           L:1956 - syncTrans 2400!:update TB_TRANS set  SETTLE_RCODE='2400',SETTLE_PROC_DATE='20170626'  where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and   CUT_DATE <= '20170626'    and SETTLE_PROC_DATE is null    and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in       (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO         from TB_TRANS_DTL        where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )           and SETTLE_PROC_DATE='20170626'          and SETTLE_RCODE <> '0000')
[main] 20170626 17:46:43 DEBUG DBService            L:1155 - update TB_TRANS set  SETTLE_RCODE='2400',SETTLE_PROC_DATE='20170626'  where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and   CUT_DATE <= '20170626'    and SETTLE_PROC_DATE is null    and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in       (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO         from TB_TRANS_DTL        where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )           and SETTLE_PROC_DATE='20170626'          and SETTLE_RCODE <> '0000')
[main] 20170626 17:46:43 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:43 INFO  ProcSettle           L:1977 - syncTrans 0000!:update TB_TRANS set  SETTLE_RCODE='0000',SETTLE_PROC_DATE='20170626' where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and   CUT_DATE <= '20170626'    and SETTLE_PROC_DATE is null    and SETTLE_RCODE='0000'   and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in      (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO        from TB_TRANS_DTL       where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )          and SETTLE_PROC_DATE='20170626'         and SETTLE_RCODE='0000'         Group by CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO)
[main] 20170626 17:46:43 DEBUG DBService            L:1155 - update TB_TRANS set  SETTLE_RCODE='0000',SETTLE_PROC_DATE='20170626' where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and   CUT_DATE <= '20170626'    and SETTLE_PROC_DATE is null    and SETTLE_RCODE='0000'   and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in      (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO        from TB_TRANS_DTL       where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )          and SETTLE_PROC_DATE='20170626'         and SETTLE_RCODE='0000'         Group by CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO)
[main] 20170626 17:46:43 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:43 INFO  ProcSettle           L:1998 - syncTrans succ!:update TB_TRANS set SETTLE_SUCC_DATE='20170626' where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and   CUT_DATE <= '20170626'    and SETTLE_PROC_DATE is not null    and SETTLE_SUCC_DATE is null    and SETTLE_RCODE='0000'   and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in      (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO        from TB_TRANS_DTL       where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )          and SETTLE_PROC_DATE='20170626'         and SETTLE_SUCC_DATE='20170626'         and SETTLE_RCODE='0000'         Group by CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO)
[main] 20170626 17:46:43 DEBUG DBService            L:1155 - update TB_TRANS set SETTLE_SUCC_DATE='20170626' where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and   CUT_DATE <= '20170626'    and SETTLE_PROC_DATE is not null    and SETTLE_SUCC_DATE is null    and SETTLE_RCODE='0000'   and (CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO) in      (select CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO        from TB_TRANS_DTL       where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )          and SETTLE_PROC_DATE='20170626'         and SETTLE_SUCC_DATE='20170626'         and SETTLE_RCODE='0000'         Group by CARD_NO, EXPIRY_DATE, LMS_INVOICE_NO)
[main] 20170626 17:46:43 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:43 DEBUG DBService            L:1155 - update TB_TRANS set   SETTLE_PROC_DATE='20170626' ,SETTLE_RCODE='0000' ,TXN_NOTE=(txn_note||'[SETTLE]17:46:43NoProcessed.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null 
[main] 20170626 17:46:43 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:43 INFO  ProcSettle           L:1918 - remarkNoProcessedTxnDtl() update TB_TRANS_DTL set   SETTLE_PROC_DATE='20170626' ,SETTLE_RCODE='0000' ,TXN_NOTE=(txn_note||'[SETTLE]17:46:43NoProcessed.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null 
[main] 20170626 17:46:43 DEBUG DBService            L:1155 - update TB_TRANS_DTL set   SETTLE_PROC_DATE='20170626' ,SETTLE_RCODE='0000' ,TXN_NOTE=(txn_note||'[SETTLE]17:46:43NoProcessed.') where   ( PAR_MON='05' or (PAR_MON='06' and PAR_DAY<='26') )    and SETTLE_PROC_DATE is null 
[main] 20170626 17:46:43 DEBUG DBService            L:1183 - update(insert) count:0
[main] 20170626 17:46:43 INFO  ProcSettle           L:315  - end process!

[main] 20170626 17:46:43 DEBUG TbBatchResultMgr     L:147  - sql: UPDATE TB_BATCH_RESULT SET END_DATE = '20170626', END_TIME = '174643', WORK_FLAG = '1', RCODE = '0000', ERROR_DESC = '', PAR_MON = '06', PAR_DAY = '26', LINK_CONTROL = 'N', MEM_ID = '', RECOVER_VALUE = '' WHERE PROGRAM_NAME = 'ProcSettle' AND START_DATE = '20170626' AND START_TIME = '174640' AND JOB_ID = '000' AND JOB_TIME = '000000'
[main] 20170626 17:46:43 DEBUG TbBatchResultMgr     L:151  - TB_BATCH_RESULT: 1 record updated
[main] 20170626 17:46:43 DEBUG TbBatchResultMgr     L:152  - [TbBatchResultInfo  sProgramName:ProcSettle sStartDate:20170626 sStartTime:174640 sEndDate:20170626 sEndTime:174643 sWorkFlag:1 sRcode:0000 sErrorDesc: sParMon:06 sParDay:26 sLinkControl:N sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20170626 17:46:43 INFO  AbstractBatchBasic   L:150  - end running

