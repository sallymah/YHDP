[main] 20200610 16:41:00 WARN  DBService            L:794  - DBCP borrow connection time: 6027 ms. batch
[main] 20200610 16:41:01 WARN  ExpBlackCard         L:106  - seqnoSql: SELECT LPAD(NVL(TO_CHAR(TO_NUMBER(MAX(SEQNO)) + 1), '01'), 2, '0') FROM TB_OUTCTL WHERE MEM_ID = '00001001' AND FILE_NAME = 'BLACKCARD' AND FILE_DATE = '20200610'
[main] 20200610 16:41:01 INFO  ExpBlackCard         L:118  - memIds:[00001001]
[main] 20200610 16:41:01 INFO  ExpBlackCard         L:119  - memId2Seqno:{00001001=01}
[main] 20200610 16:41:01 INFO  AbstractBatchBasic   L:109  - begin running
[main] 20200610 16:41:01 DEBUG TbBatchResultMgr     L:60   - sql: INSERT INTO TB_BATCH_RESULT(PROGRAM_NAME, START_DATE, START_TIME, END_DATE, END_TIME, WORK_FLAG, RCODE, ERROR_DESC, PAR_MON, PAR_DAY, LINK_CONTROL, JOB_ID, JOB_TIME, MEM_ID, RECOVER_VALUE) VALUES ('ExpBlackCard', '20200610', '164101', '', '', '0', '0000', '', '06', '10', 'N', '000', '000000', '', '')
[main] 20200610 16:41:01 DEBUG TbBatchResultMgr     L:64   - TB_BATCH_RESULT: 1 record inserted
[main] 20200610 16:41:01 DEBUG TbBatchResultMgr     L:65   - [TbBatchResultInfo  sProgramName:ExpBlackCard sStartDate:20200610 sStartTime:164101 sEndDate: sEndTime: sWorkFlag:0 sRcode:0000 sErrorDesc: sParMon:06 sParDay:10 sLinkControl:N sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20200610 16:41:01 INFO  ExpBlackCard         L:195  - SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610)) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC
[main] 20200610 16:41:01 INFO  ExpBlackCard         L:195  - SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610)) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC
[main] 20200610 16:41:01 DEBUG TbFileInfoMgr        L:253  - sql: SELECT ROWID, FILE_NAME, IN_OUT, FILE_TYPE, DATA_LEN, FILE_NAME_PATTERN, LOCAL_PATH, UPT_USERID, UPT_DATE, UPT_TIME, APRV_USERID, APRV_DATE, APRV_TIME, OK_FLAG, SUB_FILE_NAME, RETURN_FILE_NAME, CIPHER_FLAG, KEY_WORD FROM TB_FILE_INFO WHERE FILE_NAME = 'BLACKCARD' AND IN_OUT = 'O'
[main] 20200610 16:41:01 DEBUG TbFileInfoMgr        L:266  - TB_FILE_INFO: 1 records exist
[main] 20200610 16:41:01 DEBUG TbFileInfoMgr        L:267  - [TbFileInfoPK  sFileName:BLACKCARD sInOut:O]
[main] 20200610 16:41:01 DEBUG TbOutctlMgr          L:272  - sql: SELECT ROWID, MEM_ID, FILE_NAME, FILE_DATE, SEQNO, FILE_TYPE, WORK_FLAG, TOT_REC, FILE_SIZE, FULL_FILE_NAME, PROGRAM_NAME, START_DATE, START_TIME, PAR_MON, PAR_DAY, SYS_DATE, SYS_TIME, MEM_GROUP_ID, MERCH_ID FROM TB_OUTCTL WHERE MEM_ID = '00001001' AND FILE_NAME = 'BLACKCARD' AND FILE_DATE = '20200610' AND SEQNO = '01'
[main] 20200610 16:41:01 DEBUG TbOutctlMgr          L:285  - TB_OUTCTL: 0 records exist
[main] 20200610 16:41:01 DEBUG TbOutctlMgr          L:286  - [TbOutctlPK  sMemId:00001001 sFileName:BLACKCARD sFileDate:20200610 sSeqno:01]
[main] 20200610 16:41:01 WARN  ExpFileResult        L:129  - query totalCount fail for 'SELECT COUNT(*) FROM (SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610)) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC)':ORA-00907: 움|쩵쳾많

java.sql.SQLException: ORA-00907: 움|쩵쳾많

	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:447)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:396)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:951)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:513)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:227)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:195)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:869)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1175)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1296)
	at oracle.jdbc.driver.OracleStatement.executeQuery(OracleStatement.java:1498)
	at oracle.jdbc.driver.OracleStatementWrapper.executeQuery(OracleStatementWrapper.java:406)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.checkCounts(ExpFileResult.java:123)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.startProcess(ExpFileResult.java:162)
	at tw.com.hyweb.svc.yhdp.batch.framework.AbstractExpFile.process(AbstractExpFile.java:588)
	at tw.com.hyweb.core.cp.batch.framework.AbstractBatchBasic.run(AbstractBatchBasic.java:114)
	at tw.com.hyweb.svc.yhdp.batch.expfiles.ExpBlackCard.main(ExpBlackCard.java:286)
[main] 20200610 16:41:01 WARN  AbstractExpFile      L:598  - handle one expFileinfo error for '[ExpFileInfo:  memGroupId: memId:00001001 merchId: fileName:BLACKCARD fileDate:20200610 seqno:01 seqnoStart:-1 seqnoEnd:-1 fullFileName:20200610001_BlackCard_Citi.txt selectSQL:SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610)) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC checkFlag:false fileEncoding:UTF-8 usingTempFile:true tempFilePending:.TMP expTempFullFileName: expFullFileName: expFile:null expTempFile:null recordsPerFlush:-1 recordsPerFile:-1 lineSeparator:dos fileInfo:[TbFileInfoInfo  sFileName:BLACKCARD sInOut:O sFileType:B sDataLen:0 sFileNamePattern:d{11}_BlackCard_Citi.txt sLocalPath:out/BLACKCARD/ sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sOkFlag:1 sSubFileName:.OK sReturnFileName: sCipherFlag:0 sKeyWord:]]':ORA-00907: 움|쩵쳾많

java.sql.SQLException: ORA-00907: 움|쩵쳾많

	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:447)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:396)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:951)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:513)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:227)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:195)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:869)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1175)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1296)
	at oracle.jdbc.driver.OracleStatement.executeQuery(OracleStatement.java:1498)
	at oracle.jdbc.driver.OracleStatementWrapper.executeQuery(OracleStatementWrapper.java:406)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.checkCounts(ExpFileResult.java:123)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.startProcess(ExpFileResult.java:162)
	at tw.com.hyweb.svc.yhdp.batch.framework.AbstractExpFile.process(AbstractExpFile.java:588)
	at tw.com.hyweb.core.cp.batch.framework.AbstractBatchBasic.run(AbstractBatchBasic.java:114)
	at tw.com.hyweb.svc.yhdp.batch.expfiles.ExpBlackCard.main(ExpBlackCard.java:286)
[main] 20200610 16:41:01 DEBUG TbBatchResultMgr     L:147  - sql: UPDATE TB_BATCH_RESULT SET END_DATE = '20200610', END_TIME = '164101', WORK_FLAG = '1', RCODE = '2001', ERROR_DESC = 'ORA-00907: 움|쩵쳾많
', PAR_MON = '06', PAR_DAY = '10', LINK_CONTROL = 'O', MEM_ID = '', RECOVER_VALUE = '' WHERE PROGRAM_NAME = 'ExpBlackCard' AND START_DATE = '20200610' AND START_TIME = '164101' AND JOB_ID = '000' AND JOB_TIME = '000000'
[main] 20200610 16:41:01 DEBUG TbBatchResultMgr     L:151  - TB_BATCH_RESULT: 1 record updated
[main] 20200610 16:41:01 DEBUG TbBatchResultMgr     L:152  - [TbBatchResultInfo  sProgramName:ExpBlackCard sStartDate:20200610 sStartTime:164101 sEndDate:20200610 sEndTime:164101 sWorkFlag:1 sRcode:2001 sErrorDesc:ORA-00907: 움|쩵쳾많
 sParMon:06 sParDay:10 sLinkControl:O sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20200610 16:41:01 INFO  AbstractBatchBasic   L:150  - end running

[main] 20200610 16:42:18 WARN  DBService            L:794  - DBCP borrow connection time: 5897 ms. batch
[main] 20200610 16:42:18 WARN  ExpBlackCard         L:106  - seqnoSql: SELECT LPAD(NVL(TO_CHAR(TO_NUMBER(MAX(SEQNO)) + 1), '01'), 2, '0') FROM TB_OUTCTL WHERE MEM_ID = '00001001' AND FILE_NAME = 'BLACKCARD' AND FILE_DATE = '20200610'
[main] 20200610 16:42:18 INFO  ExpBlackCard         L:118  - memIds:[00001001]
[main] 20200610 16:42:18 INFO  ExpBlackCard         L:119  - memId2Seqno:{00001001=01}
[main] 20200610 16:42:18 INFO  AbstractBatchBasic   L:109  - begin running
[main] 20200610 16:42:18 DEBUG TbBatchResultMgr     L:60   - sql: INSERT INTO TB_BATCH_RESULT(PROGRAM_NAME, START_DATE, START_TIME, END_DATE, END_TIME, WORK_FLAG, RCODE, ERROR_DESC, PAR_MON, PAR_DAY, LINK_CONTROL, JOB_ID, JOB_TIME, MEM_ID, RECOVER_VALUE) VALUES ('ExpBlackCard', '20200610', '164218', '', '', '0', '0000', '', '06', '10', 'N', '000', '000000', '', '')
[main] 20200610 16:42:18 DEBUG TbBatchResultMgr     L:64   - TB_BATCH_RESULT: 1 record inserted
[main] 20200610 16:42:18 DEBUG TbBatchResultMgr     L:65   - [TbBatchResultInfo  sProgramName:ExpBlackCard sStartDate:20200610 sStartTime:164218 sEndDate: sEndTime: sWorkFlag:0 sRcode:0000 sErrorDesc: sParMon:06 sParDay:10 sLinkControl:N sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20200610 16:42:18 INFO  ExpBlackCard         L:195  - SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC
[main] 20200610 16:42:18 INFO  ExpBlackCard         L:195  - SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC
[main] 20200610 16:42:19 DEBUG TbFileInfoMgr        L:253  - sql: SELECT ROWID, FILE_NAME, IN_OUT, FILE_TYPE, DATA_LEN, FILE_NAME_PATTERN, LOCAL_PATH, UPT_USERID, UPT_DATE, UPT_TIME, APRV_USERID, APRV_DATE, APRV_TIME, OK_FLAG, SUB_FILE_NAME, RETURN_FILE_NAME, CIPHER_FLAG, KEY_WORD FROM TB_FILE_INFO WHERE FILE_NAME = 'BLACKCARD' AND IN_OUT = 'O'
[main] 20200610 16:42:19 DEBUG TbFileInfoMgr        L:266  - TB_FILE_INFO: 1 records exist
[main] 20200610 16:42:19 DEBUG TbFileInfoMgr        L:267  - [TbFileInfoPK  sFileName:BLACKCARD sInOut:O]
[main] 20200610 16:42:19 DEBUG TbOutctlMgr          L:272  - sql: SELECT ROWID, MEM_ID, FILE_NAME, FILE_DATE, SEQNO, FILE_TYPE, WORK_FLAG, TOT_REC, FILE_SIZE, FULL_FILE_NAME, PROGRAM_NAME, START_DATE, START_TIME, PAR_MON, PAR_DAY, SYS_DATE, SYS_TIME, MEM_GROUP_ID, MERCH_ID FROM TB_OUTCTL WHERE MEM_ID = '00001001' AND FILE_NAME = 'BLACKCARD' AND FILE_DATE = '20200610' AND SEQNO = '01'
[main] 20200610 16:42:19 DEBUG TbOutctlMgr          L:285  - TB_OUTCTL: 0 records exist
[main] 20200610 16:42:19 DEBUG TbOutctlMgr          L:286  - [TbOutctlPK  sMemId:00001001 sFileName:BLACKCARD sFileDate:20200610 sSeqno:01]
[main] 20200610 16:42:19 WARN  ExpFileResult        L:129  - query totalCount fail for 'SELECT COUNT(*) FROM (SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC)':ORA-00907: 움|쩵쳾많

java.sql.SQLException: ORA-00907: 움|쩵쳾많

	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:447)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:396)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:951)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:513)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:227)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:195)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:869)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1175)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1296)
	at oracle.jdbc.driver.OracleStatement.executeQuery(OracleStatement.java:1498)
	at oracle.jdbc.driver.OracleStatementWrapper.executeQuery(OracleStatementWrapper.java:406)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.checkCounts(ExpFileResult.java:123)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.startProcess(ExpFileResult.java:162)
	at tw.com.hyweb.svc.yhdp.batch.framework.AbstractExpFile.process(AbstractExpFile.java:588)
	at tw.com.hyweb.core.cp.batch.framework.AbstractBatchBasic.run(AbstractBatchBasic.java:114)
	at tw.com.hyweb.svc.yhdp.batch.expfiles.ExpBlackCard.main(ExpBlackCard.java:286)
[main] 20200610 16:42:19 WARN  AbstractExpFile      L:598  - handle one expFileinfo error for '[ExpFileInfo:  memGroupId: memId:00001001 merchId: fileName:BLACKCARD fileDate:20200610 seqno:01 seqnoStart:-1 seqnoEnd:-1 fullFileName:20200610001_BlackCard_Citi.txt selectSQL:SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC checkFlag:false fileEncoding:UTF-8 usingTempFile:true tempFilePending:.TMP expTempFullFileName: expFullFileName: expFile:null expTempFile:null recordsPerFlush:-1 recordsPerFile:-1 lineSeparator:dos fileInfo:[TbFileInfoInfo  sFileName:BLACKCARD sInOut:O sFileType:B sDataLen:0 sFileNamePattern:d{11}_BlackCard_Citi.txt sLocalPath:out/BLACKCARD/ sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sOkFlag:1 sSubFileName:.OK sReturnFileName: sCipherFlag:0 sKeyWord:]]':ORA-00907: 움|쩵쳾많

java.sql.SQLException: ORA-00907: 움|쩵쳾많

	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:447)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:396)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:951)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:513)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:227)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:195)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:869)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1175)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1296)
	at oracle.jdbc.driver.OracleStatement.executeQuery(OracleStatement.java:1498)
	at oracle.jdbc.driver.OracleStatementWrapper.executeQuery(OracleStatementWrapper.java:406)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.checkCounts(ExpFileResult.java:123)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.startProcess(ExpFileResult.java:162)
	at tw.com.hyweb.svc.yhdp.batch.framework.AbstractExpFile.process(AbstractExpFile.java:588)
	at tw.com.hyweb.core.cp.batch.framework.AbstractBatchBasic.run(AbstractBatchBasic.java:114)
	at tw.com.hyweb.svc.yhdp.batch.expfiles.ExpBlackCard.main(ExpBlackCard.java:286)
[main] 20200610 16:42:19 DEBUG TbBatchResultMgr     L:147  - sql: UPDATE TB_BATCH_RESULT SET END_DATE = '20200610', END_TIME = '164219', WORK_FLAG = '1', RCODE = '2001', ERROR_DESC = 'ORA-00907: 움|쩵쳾많
', PAR_MON = '06', PAR_DAY = '10', LINK_CONTROL = 'O', MEM_ID = '', RECOVER_VALUE = '' WHERE PROGRAM_NAME = 'ExpBlackCard' AND START_DATE = '20200610' AND START_TIME = '164218' AND JOB_ID = '000' AND JOB_TIME = '000000'
[main] 20200610 16:42:19 DEBUG TbBatchResultMgr     L:151  - TB_BATCH_RESULT: 1 record updated
[main] 20200610 16:42:19 DEBUG TbBatchResultMgr     L:152  - [TbBatchResultInfo  sProgramName:ExpBlackCard sStartDate:20200610 sStartTime:164218 sEndDate:20200610 sEndTime:164219 sWorkFlag:1 sRcode:2001 sErrorDesc:ORA-00907: 움|쩵쳾많
 sParMon:06 sParDay:10 sLinkControl:O sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20200610 16:42:19 INFO  AbstractBatchBasic   L:150  - end running

[main] 20200610 16:45:09 WARN  DBService            L:794  - DBCP borrow connection time: 5784 ms. batch
[main] 20200610 16:45:09 WARN  ExpBlackCard         L:106  - seqnoSql: SELECT LPAD(NVL(TO_CHAR(TO_NUMBER(MAX(SEQNO)) + 1), '01'), 2, '0') FROM TB_OUTCTL WHERE MEM_ID = '00001001' AND FILE_NAME = 'BLACKCARD' AND FILE_DATE = '20200610'
[main] 20200610 16:45:09 INFO  ExpBlackCard         L:118  - memIds:[00001001]
[main] 20200610 16:45:09 INFO  ExpBlackCard         L:119  - memId2Seqno:{00001001=01}
[main] 20200610 16:45:09 INFO  AbstractBatchBasic   L:109  - begin running
[main] 20200610 16:45:09 DEBUG TbBatchResultMgr     L:60   - sql: INSERT INTO TB_BATCH_RESULT(PROGRAM_NAME, START_DATE, START_TIME, END_DATE, END_TIME, WORK_FLAG, RCODE, ERROR_DESC, PAR_MON, PAR_DAY, LINK_CONTROL, JOB_ID, JOB_TIME, MEM_ID, RECOVER_VALUE) VALUES ('ExpBlackCard', '20200610', '164509', '', '', '0', '0000', '', '06', '10', 'N', '000', '000000', '', '')
[main] 20200610 16:45:09 DEBUG TbBatchResultMgr     L:64   - TB_BATCH_RESULT: 1 record inserted
[main] 20200610 16:45:09 DEBUG TbBatchResultMgr     L:65   - [TbBatchResultInfo  sProgramName:ExpBlackCard sStartDate:20200610 sStartTime:164509 sEndDate: sEndTime: sWorkFlag:0 sRcode:0000 sErrorDesc: sParMon:06 sParDay:10 sLinkControl:N sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20200610 16:45:09 INFO  ExpBlackCard         L:195  - SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610)WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC
[main] 20200610 16:45:09 INFO  ExpBlackCard         L:195  - SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610)WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC
[main] 20200610 16:45:09 DEBUG TbFileInfoMgr        L:253  - sql: SELECT ROWID, FILE_NAME, IN_OUT, FILE_TYPE, DATA_LEN, FILE_NAME_PATTERN, LOCAL_PATH, UPT_USERID, UPT_DATE, UPT_TIME, APRV_USERID, APRV_DATE, APRV_TIME, OK_FLAG, SUB_FILE_NAME, RETURN_FILE_NAME, CIPHER_FLAG, KEY_WORD FROM TB_FILE_INFO WHERE FILE_NAME = 'BLACKCARD' AND IN_OUT = 'O'
[main] 20200610 16:45:09 DEBUG TbFileInfoMgr        L:266  - TB_FILE_INFO: 1 records exist
[main] 20200610 16:45:09 DEBUG TbFileInfoMgr        L:267  - [TbFileInfoPK  sFileName:BLACKCARD sInOut:O]
[main] 20200610 16:45:09 DEBUG TbOutctlMgr          L:272  - sql: SELECT ROWID, MEM_ID, FILE_NAME, FILE_DATE, SEQNO, FILE_TYPE, WORK_FLAG, TOT_REC, FILE_SIZE, FULL_FILE_NAME, PROGRAM_NAME, START_DATE, START_TIME, PAR_MON, PAR_DAY, SYS_DATE, SYS_TIME, MEM_GROUP_ID, MERCH_ID FROM TB_OUTCTL WHERE MEM_ID = '00001001' AND FILE_NAME = 'BLACKCARD' AND FILE_DATE = '20200610' AND SEQNO = '01'
[main] 20200610 16:45:09 DEBUG TbOutctlMgr          L:285  - TB_OUTCTL: 0 records exist
[main] 20200610 16:45:09 DEBUG TbOutctlMgr          L:286  - [TbOutctlPK  sMemId:00001001 sFileName:BLACKCARD sFileDate:20200610 sSeqno:01]
[main] 20200610 16:45:09 WARN  ExpFileResult        L:129  - query totalCount fail for 'SELECT COUNT(*) FROM (SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610)WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC)':ORA-00907: 움|쩵쳾많

java.sql.SQLException: ORA-00907: 움|쩵쳾많

	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:447)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:396)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:951)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:513)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:227)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:195)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:869)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1175)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1296)
	at oracle.jdbc.driver.OracleStatement.executeQuery(OracleStatement.java:1498)
	at oracle.jdbc.driver.OracleStatementWrapper.executeQuery(OracleStatementWrapper.java:406)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.checkCounts(ExpFileResult.java:123)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.startProcess(ExpFileResult.java:162)
	at tw.com.hyweb.svc.yhdp.batch.framework.AbstractExpFile.process(AbstractExpFile.java:588)
	at tw.com.hyweb.core.cp.batch.framework.AbstractBatchBasic.run(AbstractBatchBasic.java:114)
	at tw.com.hyweb.svc.yhdp.batch.expfiles.ExpBlackCard.main(ExpBlackCard.java:286)
[main] 20200610 16:45:09 WARN  AbstractExpFile      L:598  - handle one expFileinfo error for '[ExpFileInfo:  memGroupId: memId:00001001 merchId: fileName:BLACKCARD fileDate:20200610 seqno:01 seqnoStart:-1 seqnoEnd:-1 fullFileName:20200610001_BlackCard_Citi.txt selectSQL:SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NOAND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610)WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC checkFlag:false fileEncoding:UTF-8 usingTempFile:true tempFilePending:.TMP expTempFullFileName: expFullFileName: expFile:null expTempFile:null recordsPerFlush:-1 recordsPerFile:-1 lineSeparator:dos fileInfo:[TbFileInfoInfo  sFileName:BLACKCARD sInOut:O sFileType:B sDataLen:0 sFileNamePattern:d{11}_BlackCard_Citi.txt sLocalPath:out/BLACKCARD/ sUptUserid: sUptDate: sUptTime: sAprvUserid: sAprvDate: sAprvTime: sOkFlag:1 sSubFileName:.OK sReturnFileName: sCipherFlag:0 sKeyWord:]]':ORA-00907: 움|쩵쳾많

java.sql.SQLException: ORA-00907: 움|쩵쳾많

	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:447)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:396)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:951)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:513)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:227)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:531)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:195)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:869)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1175)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1296)
	at oracle.jdbc.driver.OracleStatement.executeQuery(OracleStatement.java:1498)
	at oracle.jdbc.driver.OracleStatementWrapper.executeQuery(OracleStatementWrapper.java:406)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:205)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.checkCounts(ExpFileResult.java:123)
	at tw.com.hyweb.core.cp.batch.framework.expfiles.ExpFileResult.startProcess(ExpFileResult.java:162)
	at tw.com.hyweb.svc.yhdp.batch.framework.AbstractExpFile.process(AbstractExpFile.java:588)
	at tw.com.hyweb.core.cp.batch.framework.AbstractBatchBasic.run(AbstractBatchBasic.java:114)
	at tw.com.hyweb.svc.yhdp.batch.expfiles.ExpBlackCard.main(ExpBlackCard.java:286)
[main] 20200610 16:45:10 DEBUG TbBatchResultMgr     L:147  - sql: UPDATE TB_BATCH_RESULT SET END_DATE = '20200610', END_TIME = '164510', WORK_FLAG = '1', RCODE = '2001', ERROR_DESC = 'ORA-00907: 움|쩵쳾많
', PAR_MON = '06', PAR_DAY = '10', LINK_CONTROL = 'O', MEM_ID = '', RECOVER_VALUE = '' WHERE PROGRAM_NAME = 'ExpBlackCard' AND START_DATE = '20200610' AND START_TIME = '164509' AND JOB_ID = '000' AND JOB_TIME = '000000'
[main] 20200610 16:45:10 DEBUG TbBatchResultMgr     L:151  - TB_BATCH_RESULT: 1 record updated
[main] 20200610 16:45:10 DEBUG TbBatchResultMgr     L:152  - [TbBatchResultInfo  sProgramName:ExpBlackCard sStartDate:20200610 sStartTime:164509 sEndDate:20200610 sEndTime:164510 sWorkFlag:1 sRcode:2001 sErrorDesc:ORA-00907: 움|쩵쳾많
 sParMon:06 sParDay:10 sLinkControl:O sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20200610 16:45:10 INFO  AbstractBatchBasic   L:150  - end running

[main] 20200610 16:46:08 WARN  DBService            L:794  - DBCP borrow connection time: 5767 ms. batch
[main] 20200610 16:46:08 WARN  ExpBlackCard         L:106  - seqnoSql: SELECT LPAD(NVL(TO_CHAR(TO_NUMBER(MAX(SEQNO)) + 1), '01'), 2, '0') FROM TB_OUTCTL WHERE MEM_ID = '00001001' AND FILE_NAME = 'BLACKCARD' AND FILE_DATE = '20200610'
[main] 20200610 16:46:08 INFO  ExpBlackCard         L:118  - memIds:[00001001]
[main] 20200610 16:46:08 INFO  ExpBlackCard         L:119  - memId2Seqno:{00001001=01}
[main] 20200610 16:46:08 INFO  AbstractBatchBasic   L:109  - begin running
[main] 20200610 16:46:08 DEBUG TbBatchResultMgr     L:60   - sql: INSERT INTO TB_BATCH_RESULT(PROGRAM_NAME, START_DATE, START_TIME, END_DATE, END_TIME, WORK_FLAG, RCODE, ERROR_DESC, PAR_MON, PAR_DAY, LINK_CONTROL, JOB_ID, JOB_TIME, MEM_ID, RECOVER_VALUE) VALUES ('ExpBlackCard', '20200610', '164608', '', '', '0', '0000', '', '06', '10', 'N', '000', '000000', '', '')
[main] 20200610 16:46:08 DEBUG TbBatchResultMgr     L:64   - TB_BATCH_RESULT: 1 record inserted
[main] 20200610 16:46:08 DEBUG TbBatchResultMgr     L:65   - [TbBatchResultInfo  sProgramName:ExpBlackCard sStartDate:20200610 sStartTime:164608 sEndDate: sEndTime: sWorkFlag:0 sRcode:0000 sErrorDesc: sParMon:06 sParDay:10 sLinkControl:N sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20200610 16:46:08 INFO  ExpBlackCard         L:195  - SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NO AND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610)WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC
[main] 20200610 16:46:08 INFO  ExpBlackCard         L:195  - SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM( SELECT CARD_NO, BLACKLIST_CODE, BLOCK_DATE, REG_DATE, APRV_USERID FROM TB_BLACKLIST_SETTING WHERE STATUS ='1' AND EXISTS(SELECT * FROM TB_HG_CARD_MAP WHERE TB_BLACKLIST_SETTING.CARD_NO= TB_HG_CARD_MAP.CARD_NO ) UNION SELECT CARD_NO, CASE WHEN (P_CODE='9757' OR P_CODE='9827') THEN '00' WHEN( P_CODE='9847' OR P_CODE='9767') THEN '01' WHEN P_CODE='7247' THEN ' ' END AS  BLACKLIST_CODE, '' AS BLOCK_DATE , TXN_DATE AS REG_DATE, '' AS APRV_USERID FROM TB_ONL_TXN WHERE STATUS ='1' AND P_CODE IN ('7247','9757','9827','9847','9767') AND EXISTS ( SELECT * FROM TB_HG_CARD_MAP WHERE TB_ONL_TXN.CARD_NO= TB_HG_CARD_MAP.CARD_NO) AND NOT EXISTS ( SELECT * FROM TB_BLACKLIST_SETTING WHERE TB_ONL_TXN.CARD_NO= TB_BLACKLIST_SETTING.CARD_NO AND TB_ONL_TXN.EXPIRY_DATE= TB_BLACKLIST_SETTING.EXPIRY_DATE) ) WHERE BLACKLIST_CODE <> '03' ) WHERE BLOCK_DATE IS NOT NULL AND REG_DATE <= 20180610)WHERE BLACKLIST_CODE <> '04' OR (BLACKLIST_CODE = '04' AND REG_DATE <=  20200603) )B WHERE ( BLACKLIST_CODE <> '01' OR  APRV_USERID  <> 'CRM') AND (BLACKLIST_CODE = '01' AND  APRV_USERID  = 'CRM' AND (CARD_NO NOT IN( SELECT CARD_NO FROM TB_CARD_BAL WHERE TB_CARD_BAL.CARD_NO= B.CARD_NO AND CR_BONUS_QTY - DB_BONUS_QTY + BAL_BONUS_QTY = 0) OR REG_DATE <=  20190610))) WHERE BLACKLIST_CODE <> '05' OR (BLACKLIST_CODE = '05' AND REG_DATE <= 20170610) )A  WHERE NOT EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) OR (EXISTS (SELECT * FROM TB_BAL_TRANSFER_DTL WHERE A.CARD_NO = TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID AND TB_BAL_TRANSFER_DTL.ORIG_BALANCE_ID LIKE '9%' AND BONUS_QTY = 0) AND REG_DATE >= 20230610) ORDER BY CARD_NO ASC
[main] 20200610 16:46:08 DEBUG TbFileInfoMgr        L:253  - sql: SELECT ROWID, FILE_NAME, IN_OUT, FILE_TYPE, DATA_LEN, FILE_NAME_PATTERN, LOCAL_PATH, UPT_USERID, UPT_DATE, UPT_TIME, APRV_USERID, APRV_DATE, APRV_TIME, OK_FLAG, SUB_FILE_NAME, RETURN_FILE_NAME, CIPHER_FLAG, KEY_WORD FROM TB_FILE_INFO WHERE FILE_NAME = 'BLACKCARD' AND IN_OUT = 'O'
[main] 20200610 16:46:08 DEBUG TbFileInfoMgr        L:266  - TB_FILE_INFO: 1 records exist
[main] 20200610 16:46:08 DEBUG TbFileInfoMgr        L:267  - [TbFileInfoPK  sFileName:BLACKCARD sInOut:O]
[main] 20200610 16:46:08 DEBUG TbOutctlMgr          L:272  - sql: SELECT ROWID, MEM_ID, FILE_NAME, FILE_DATE, SEQNO, FILE_TYPE, WORK_FLAG, TOT_REC, FILE_SIZE, FULL_FILE_NAME, PROGRAM_NAME, START_DATE, START_TIME, PAR_MON, PAR_DAY, SYS_DATE, SYS_TIME, MEM_GROUP_ID, MERCH_ID FROM TB_OUTCTL WHERE MEM_ID = '00001001' AND FILE_NAME = 'BLACKCARD' AND FILE_DATE = '20200610' AND SEQNO = '01'
[main] 20200610 16:46:08 DEBUG TbOutctlMgr          L:285  - TB_OUTCTL: 0 records exist
[main] 20200610 16:46:08 DEBUG TbOutctlMgr          L:286  - [TbOutctlPK  sMemId:00001001 sFileName:BLACKCARD sFileDate:20200610 sSeqno:01]
[main] 20200610 16:46:08 DEBUG TbOutctlMgr          L:60   - sql: INSERT INTO TB_OUTCTL(MEM_ID, FILE_NAME, FILE_DATE, SEQNO, FILE_TYPE, WORK_FLAG, TOT_REC, FILE_SIZE, FULL_FILE_NAME, PROGRAM_NAME, START_DATE, START_TIME, PAR_MON, PAR_DAY, SYS_DATE, SYS_TIME, MEM_GROUP_ID, MERCH_ID) VALUES ('00001001', 'BLACKCARD', '20200610', '01', 'B', '1', 0, 40, '20200610001_BlackCard_Citi.txt', 'ExpBlackCard', '20200610', '164608', '06', '10', '20200610', '164608', '', '')
[main] 20200610 16:46:08 DEBUG TbOutctlMgr          L:64   - TB_OUTCTL: 1 record inserted
[main] 20200610 16:46:08 DEBUG TbOutctlMgr          L:65   - [TbOutctlInfo  sMemId:00001001 sFileName:BLACKCARD sFileDate:20200610 sSeqno:01 sFileType:B sWorkFlag:1 sTotRec:0 sFileSize:40 sFullFileName:20200610001_BlackCard_Citi.txt sProgramName:ExpBlackCard sStartDate:20200610 sStartTime:164608 sParMon:06 sParDay:10 sSysDate:20200610 sSysTime:164608 sMemGroupId: sMerchId:]
[main] 20200610 16:46:09 DEBUG TbBatchResultMgr     L:147  - sql: UPDATE TB_BATCH_RESULT SET END_DATE = '20200610', END_TIME = '164609', WORK_FLAG = '1', RCODE = '0000', ERROR_DESC = 'success Exp Files:1', PAR_MON = '06', PAR_DAY = '10', LINK_CONTROL = 'O', MEM_ID = '', RECOVER_VALUE = '' WHERE PROGRAM_NAME = 'ExpBlackCard' AND START_DATE = '20200610' AND START_TIME = '164608' AND JOB_ID = '000' AND JOB_TIME = '000000'
[main] 20200610 16:46:09 DEBUG TbBatchResultMgr     L:151  - TB_BATCH_RESULT: 1 record updated
[main] 20200610 16:46:09 DEBUG TbBatchResultMgr     L:152  - [TbBatchResultInfo  sProgramName:ExpBlackCard sStartDate:20200610 sStartTime:164608 sEndDate:20200610 sEndTime:164609 sWorkFlag:1 sRcode:0000 sErrorDesc:success Exp Files:1 sParMon:06 sParDay:10 sLinkControl:O sJobId:000 sJobTime:000000 sMemId: sRecoverValue:]
[main] 20200610 16:46:09 INFO  AbstractBatchBasic   L:150  - end running

